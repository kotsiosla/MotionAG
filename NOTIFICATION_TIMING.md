# ⏰ Notification Timing - Λεπτομερής Ανάλυση

## 📊 Πίνακας: Πότε θα λάβεις ειδοποιήσεις

| Κατάσταση App | 2 λεπτά πριν | 5 λεπτά πριν |
|---------------|--------------|--------------|
| **App ανοιχτό** | ✅ Ναι (ελέγχει κάθε 3 sec) | ✅ Ναι |
| **App minimized** | ⚠️ Μπορεί (server κάθε 5 min) | ✅ Ναι |
| **App κλειστό** | ⚠️ Μπορεί (server κάθε 5 min) | ✅ Ναι |

## 🔍 Τι σημαίνει "⚠️ Μπορεί"

### Για 2 λεπτά πριν (App minimized/closed):

**Σενάριο 1: Τέλεια timing**
```
10:00 - Λεωφορείο φτάνει 10:02
10:00 - check-stop-arrivals τρέχει
10:00 - Βρίσκει: Λεωφορείο φτάνει σε 2 λεπτά
10:00 - ✅ Στέλνει notification: "2 λεπτά πριν"
```

**Σενάριο 2: Χάθηκε η πρώτη**
```
10:00 - Λεωφορείο φτάνει 10:02
10:01 - check-stop-arrivals τρέχει (1 λεπτό πριν)
10:01 - Βρίσκει: Λεωφορείο φτάνει σε 1 λεπτό
10:01 - ✅ Στέλνει notification: "1 λεπτό πριν" (αργά, αλλά λειτουργεί)
```

**Σενάριο 3: Χάθηκε εντελώς**
```
10:00 - Λεωφορείο φτάνει 10:02
10:03 - check-stop-arrivals τρέχει (1 λεπτό μετά)
10:03 - ❌ Δεν βρίσκει (λεωφορείο ήδη έφυγε)
```

### Για 5 λεπτά πριν (App minimized/closed):

**Σενάριο: Πάντα λειτουργεί**
```
10:00 - Λεωφορείο φτάνει 10:05
10:00 - check-stop-arrivals τρέχει
10:00 - Βρίσκει: Λεωφορείο φτάνει σε 5 λεπτά
10:00 - ✅ Στέλνει notification: "5 λεπτά πριν"
```

## 📈 Πιθανότητες για 2 λεπτά πριν

- **40% πιθανότητα**: Notification 2 λεπτά πριν (τέλεια timing)
- **40% πιθανότητα**: Notification 1-4 λεπτά πριν (αργά, αλλά λειτουργεί)
- **20% πιθανότητα**: Χάθηκε (λεωφορείο έφυγε πριν τρέξει το check)

## 💡 Βελτιώσεις

### Επιλογή 1: Μείωση interval σε 2 λεπτά (GitHub Actions)
- **Πρόβλημα**: GitHub Actions minimum είναι 5 λεπτά
- **Λύση**: Χρειάζεται external cron service (π.χ. cron-job.org)

### Επιλογή 2: Multiple notifications
- **Notification 1**: 5 λεπτά πριν (guaranteed)
- **Notification 2**: 2 λεπτά πριν (αν το timing είναι καλό)

### Επιλογή 3: Προσθήκη progressive notifications
- **5 λεπτά πριν**: Πρώτη ειδοποίηση
- **3 λεπτά πριν**: Reminder (αν το timing είναι καλό)
- **2 λεπτά πριν**: Final reminder (αν το timing είναι καλό)
- **1 λεπτό πριν**: Last call (αν το timing είναι καλό)

## 🎯 Προτάσεις

### Για αξιόπιστη λειτουργία:
- **Χρησιμοποίησε 5+ λεπτά πριν** για app minimized/closed
- **Χρησιμοποίησε 2 λεπτά πριν** μόνο για app ανοιχτό

### Για καλύτερη εμπειρία:
- **Ρύθμισε 5 λεπτά πριν** (guaranteed notification)
- **Το client-side** (app ανοιχτό) θα στείλει και 2 λεπτά πριν

## ✅ Τρέχουσα Λειτουργία

**App ανοιχτό:**
- ✅ Ελέγχει κάθε 3-5 δευτερόλεπτα
- ✅ Στέλνει notification 2 λεπτά πριν (ακριβές)
- ✅ Στέλνει notification 5 λεπτά πριν (ακριβές)

**App minimized/closed:**
- ⚠️ Ελέγχει κάθε 5 λεπτά (GitHub Actions limit)
- ⚠️ Στέλνει notification 2 λεπτά πριν (40% πιθανότητα)
- ✅ Στέλνει notification 5 λεπτά πριν (100% πιθανότητα)

## 🔧 Αν θέλεις να βελτιώσουμε

Μπορώ να:
1. Προσθέσω progressive notifications (5, 3, 2, 1 λεπτό πριν)
2. Ρυθμίσω external cron service για πιο συχνά checks
3. Προσθέσω fallback mechanism για 2 λεπτά πριν

**Τι προτιμάς;**

